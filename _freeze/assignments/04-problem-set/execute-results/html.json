{
  "hash": "6c5648ff81f93697a8923575a008c9ce",
  "result": {
    "markdown": "---\ntitle: \"Problem Set 4\"\nexecute:\n  freeze: auto\n---\n\n\n::: callout-warning\nThis assignment is due by Friday november 11 by email.\n:::\n\nPlease read the [instructions](/assignments/problem-sets.html) for completing and submitting homeworks. \n\n<p style=\"text-align:center\">\n\n<p style=\"text-align:center\"><a target=\"_blank\" href=\"/files/assignment/04-problem-set-pdf.pdf\"><span class=\"btn btn-primary btn-lg\"><i class=\"fas fa-file-pdf\"></i> PDF</a></span> <a target=\"_blank\" href=\"/files/assignment/04-problem-set.zip\"><span class=\"btn btn-primary btn-lg\"><i class=\"fas fa-file-archive\"></i> R Project</a></span> <a target=\"_blank\" href=\"https://rstudio.cloud/spaces/270168/content/4867728\"><span class=\"btn btn-primary btn-lg\"><i class=\"fas fa-cloud\"></i> R Studio Cloud</a></span></p>\n\n</p>\n\nThe <i class=\"fas fa-file-pdf\"></i> PDF is useful if you want to print out the problem set and write on it. The <i class=\"fas fa-file-archive\"></i> R Project is a zipped `.zip` file which contains a <i class=\"fab fa-markdown\"></i> `.qmd` file to write answers in, and the data, all in a logical working directory. ([See this resource](/resources/zipping.qmd) for help unzipping files). You can also just write an `.R` file in the project if you don't want to use markdown. If you use the <i class=\"fas fa-cloud\"></i> cloud project, I have already installed `tidyverse` and `tinytex` (to produce pdfs).\n\n# Answers\n\n<p style=\"text-align:center\"><a target=\"_blank\" href=\"/files/assignment/04-problem-set-answers.html\"><span class=\"btn btn-primary btn-lg\"><i class=\"fas fa-external-link-square-alt\"></i> html </a></span> <a target=\"_blank\" href=\"/files/assignment/04-problem-set-answers.zip\"><span class=\"btn btn-primary btn-lg\"><i class=\"fas fa-file-archive\"></i> R Project</a></span> <a target=\"_blank\" href=\"https://rstudio.cloud/spaces/270168/content/4867728\"><span class=\"btn btn-primary btn-lg\"><i class=\"fas fa-cloud\"></i> R Studio Cloud</a></span></p>\n\n\n\n\n\n\n# Theory and Concepts\n\n## Question 1\nIn your own words, explain the fundamental problem of causal inference.\n\n## Question 2\n\nIn your own words, explain how properly conducting a randomized controlled trial helps to identify the causal effect of one variable on another.\n\n\n\n## Question 3\n\nIn your own words, describe what omitted variable bias means. What are the two conditions for a variable to bias OLS estimates if omitted?\n\n\n\n## Question 4\n\nIn your own words, describe what multicollinearity means. What is the cause, and what are the consequences of multicollinearity? How can we measure multicollinearity and its effects? What happens if multicollinearity is *perfect*?\n\n\n\n## Question 5\n\nExplain how we use Directed Acyclic Graphs (DAGs) to depict a causal model: what are the two criteria that must hold for identifying a causal effect of $X$ on $Y$? When should we control a variable, and when should we *not* control for a variable?\n\n\n\n# Theory Problems\n\nFor the following questions, please *show all work* and explain answers as necessary. You may lose points if you only write the correct answer. You may use `R` to *verify* your answers, but you are expected to reach the answers in this section \"manually.\"\n\n## Question 6\n\nA pharmaceutical company is interested in estimating the impact of a new drug on cholesterol levels. They enroll 200 people in a clinical trial. People are randomly assigned the treatment group or into the control group. Half of the people are given the new drug and half the people are given a sugar pill with no active ingredient. To examine the impact of dosage on reductions in cholesterol levels, the authors of the study regress the following model:\n\n\n$$\\text{cholesterol level}_i = \\beta_0+\\beta_1 \\text{dosage level}_i + u_i$$\n\n\nFor people in the control group, dosage level$_i=0$ and for people in the treatment group, dosage level$_i$ measures milligrams of the active ingredient. In this case, the authors find a large, negative, statistically significant estimate of $\\hat{\\beta_1}$. Is this an unbiased estimate of the impact of dosage on change in cholesterol level? Why or why not? Do you expect the estimate to overstate or understate the true relationship between dosage and cholesterol level?\n\n\n\n## Question 7\n\nData were collected from a random sample of 220 home sales from a community in 2017.\n\n\n$$\\widehat{Price}=119.2+0.485 \\, BDR+23.4 \\, Bath+0.156 \\, Hsize+0.002 \\, Lsize+0.090 \\, Age$$\n\n\n| Variable | Description |\n|----------|-------------|\n| $Price$ | selling price (in $1,000s) |\n| $BDR$ | number of bedrooms |\n| $Bath$ | number of bathrooms |\n| $Hsize$ | size of the house (in ft$^2)$ |\n| $Lsize$ | lot size (in ft$^2)$ |\n| $Age$ |age of the house (in years) |\n\n### Part A\n\nSuppose that a homeowner converts part of an existing living space in her house to a new bathroom. What is the expected increase in the value of the house?\n\n\n\n### Part B\n\nSuppose a homeowner adds a new bathroom to her house, which also increases the size of the house by 100 square feet. What is the expected increase in the value of the house?\n\n\n\n### Part C\n\nSuppose the $R^2$ of this regression is 0.727. Calculate the adjusted $\\bar{R}^2$.\n\n\n\n### Part D\n\nSuppose the following auxiliary regression for $BDR$ has an $R^2$ of 0.841.\n\n\n$$\\widehat{BDR}=\\delta_0+\\delta_1Bath+\\delta_2Hsize+\\delta_3Lsize+\\delta_4Age$$\n\n\nCalculate the Variance Inflation Factor for $BDR$ and explain what it means.\n\n\n\n## Question 8\n\nA researcher wants to investigate the effect of education on average hourly wages. Wage, education, and experience in the dataset have the following correlations:\n\n|    | Wage | Education | Experience |\n|----|-----:|----------:|-----------:|\n| Wage | 1.0000 |    |    |\n| Education | 0.4059 |  1.0000  |    |\n| Experience | 0.1129 | -0.2995 | 1.0000 |\n\nShe runs a simple regression first, and gets the results:\n\n\n$$\\widehat{\\text{Wage}} = -0.9049 +  0.5414 \\, Education$$\n\n\nShe runs another regression, and gets the results:\n\n\n$$\\widehat{\\text{Experience}} = 35.4615 - 1.4681 \\, Education$$\n\n\n### Part A\n\nIf the true marginal effect of experience on wages (holding education constant) is 0.0701, calculate the omitted variable bias in the first regression caused by omitting experience. Does the estimate of $\\hat{\\beta_1}$ in the first regression overstate or understate the effect of education on wages?\n\n\n\n### Part B\n\nKnowing this, what would be the *true effect* of education on wages, holding experience constant?\n\n\n\n### Part C\n\nThe $R^2$ for the second regression is 0.0897. If she were to run a better regression including both education and experience, how much would the variance of the coefficients on education and experience increase? Why?\n\n\n\n# R Questions\n\nAnswer the following questions using `R`. When necessary, please write answers in the same document (rendered to `html` or `pdf`, typed `.doc(x)`, or handwritten) as your answers to the above questions. Be sure to include (email or print an `.R` file, or show in your rendered quarto document) your code and the outputs of your code with the rest of your answers.\n\n## Question 9\n\n- [<i class=\"fas fa-table\"></i> `heightwages.csv`](http://metricsf22.classes.ryansafner.com/files/data/heightwages.csv)\n\nDownload and read in `heightwages.csv` dataset. If you don't want to download/upload it, you can read it in directly from the url by running this chunk:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# run or edit this chunk\nmlb <- read_csv(\"http://metricsf22.classes.ryansafner.com/files/data/heightwages.csv\")\n```\n:::\n\n\nThis data is a part of a larger dataset from the National Longitudinal Survey of Youth (NLSY) 1979 cohort: a nationally representative sample of 12,686 men and women aged 14-22 years old when they were first surveyed in 1979. They were subsequently interviewed every year through 1994 and then every other year afterwards. There are many included variables, but for now we will just focus on: \n\n| Variable | Description |\n|----------|-------------|\n| `wage96` |Adult hourly wages ($/hr) reported in 1996 |\n| `height85` | Adult height (inches) reported in 1985 |\n| `height81` | Adolescent height (inches) reported in 1981 |\n\n> We want to figure out what is the effect of height on wages (e.g. do taller people earn more on average than shorter people?)\n\n### Part A\n\nCreate a quick scatterplot between `height85` (as $X)$ amd `wage96` (as $Y)$.\n\n### Part B\n\nRegress wages on adult height. Write the equation of the estimated OLS regression. Interpret the coefficient on `height85`.\n\n### Part C\n\nHow much would someone who is 5'10\" (70 in) be predicted to earn per hour, according to the model?\n\n### Part D\n\nWould adolescent height cause an omitted variable bias if it were left out? Explain using both your intuition, and some statistical evidence with `R`.\n\n### Part E\n\nNow add adolescent height to the regression, and write the new regression equation below, as before. Interpret the coefficient on `height85`.\n\n\n### Part F\n\nHow much would someone who is 5'10\" in 1985 and 4'8\" in 1981 be predicted to earn, according to the model?\n\n### Part G\n\nWhat happened to the estimate on `height85` and its standard error?\n\n\n### Part H\n\nIs there multicollinearity between `height85` and `height81`? Explore with a scatterplot. Hint: to avoid overplotting, use `geom_jitter()` instead of `geom_point()` to get a better view of the data.\n\n\n### Part I\n\nQuantify how much multicollinearity affects the variance of the OLS estimates on both heights. Hint: You'll need the `vif` command from the `car` package.\n\n### Part J\n\nReach the same number as in part I by running an auxiliary regression.\n\nHint: There's some missing `wage96` data that may give you a different answer, so take the data and `filter(!is.na(wage96))` before running this regression — this will include only observations for `wage96` that are not `NA`'s.\n\n### Part K\n\nMake a regression table from part B and D using `modelsummary`.\n\n## Question 10\n\nInstall and load the `wooldridge` package. This package contains datasets used in Jeffrey Wooldridge's *Introductory Econometrics: A Modern Approach* (the textbook that I used in *my* econometrics classes years ago!).\n\nWe will use the `bwght` data from `wooldridge`, which comes from The 1988 National Health Interview Survey., used in J. Mullahy (1997), “Instrumental-Variable Estimation of Count Data Models: Applications to Models of Cigarette Smoking Behavior,” *Review of Economics and Statistics* 79: 596-593.\n\nLet's just look at the following variables:\n\n| Variable | Description |\n|----------|-------------|\n| `bwght` | Birth Weight (ounces) |\n| `cigs` | Cigarettes smoked per day while pregnant (1988) |\n| `motheduc` | Mother's education (number of years) |\n| `cigprice` | Price of cigarette pack (1988) |\n| `faminc` | Family's income in $1,000s (1988) |\n\n> We want to explore how a mother smoking during pregnancy affects the baby's birthweight (which may have strong effects on outcomes over the child's life).\n\nJust to be explicit about it, assign this as some dataframe (feel free to change the name), i.e.: \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# run or edit this chunk\nbirths <- bwght # feel free to rename whatever you want for the dataframe\n```\n:::\n\n\n### Part A\n\nMake a correlation table for our variables listed above.\n\nHint: `select()` these variables and then pipe this into `cor(., use = \"pairwise.complete.obs\")` to use only observations for which there are data on each variable (to avoid `NA`'s).\n\n\n### Part B\n\nConsider the following causal model:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndagify(bwght ~ cigs + inc,\n       cigs ~ price + educ + inc,\n       inc ~ educ,\n       exposure = \"cigs\",\n       outcome = \"bwght\") %>%\n  tidy_dagitty(seed = 256) %>%\n  ggdag_status()+\n  theme_dag_blank()+\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](04-problem-set_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nNote what we are hypothesizing:\n\n1. `bwght` is caused by `cigs` and `inc`\n2. `cigs` are caused by `price`, `educ`, and `inc`\n3. `inc` is caused by `educ`\n\nSee also how this is written into the notation in R to draw (plot) the DAG.\n\nCreate this model on [dagitty.net](htpp://dagitty.net). What does `dagitty` tell us the testable implications of this causal model?\n\nYou can answer this using `dagitty.net,` and/or R.\n\n\n### Part C\n\nTest each implication given to you by `dagitty.`\n\n- For independencies, e.g. $(x \\perp y)$: run a regression of $y$ on $x$.\n- For *conditional* independencies, e.g. $(x \\perp y | z, a)$: run a regression of $y$ on $x, z, a$.\n\nFor each, test against the null hypothesis that the relevant coefficient $(\\beta_1) =0$ (i.e. $x$ and $y$ are indeed independent).\n\nDoes this causal model hold up well?\n\n### Part D\n\nList *all* of the possible pathways from `cigs` to `bwght`. Which are “front-doors” and which are “back-doors?” Are any blocked by colliders?\n\nYou can answer this using `dagitty.net`, and/or R.\n\n### Part E\n\nWhat is the minimal sufficient set of variables we need to control for in order to causally identify the effect of `cigs` on `bwght`?\n\nYou can answer this using `dagitty.net,` and/or R.\n\n\n### Part F\n\nEstimate the causal effect by running the appropriate regression in `R`.\n\nFYI, on `dagitty.net`, you can change a variable on the diagram to be “*adjusted*” (controlled for) by clicking it and then hitting the `A` key.\n\n\n### Part G\n\nWe saw some effect between `faminc` and `cigprice`. Perhaps there are unobserved factors (such as the economy's performance) that affect both. Add an unobserved factor `u1` to your `dagitty` model.\n\nFYI, on `dagitty.net`, you can make a variable be \"*unobserved*\" by double-clicking it and then hitting the `U` key.\n\n### Part H\n\nPerhaps our model is poorly specified. Maybe `motheduc` actually has a causal effect on `bwght`? Tweak your model on `dagitty.net` to add this potential relationship. What testable implications does this new model imply?\n\n\n### Part I\n\nTest these implications appropriately in `R`, like you did in Part C. Does this model hold up well?\n\n\n### Part J\n\nUnder this new causal model, list *all* of the possible pathways from `cigs` to `bwght`. Which are “front-doors” and which are “back-doors?” Are any blocked by colliders?\n\nYou can answer this using `dagitty.net,` and/or R.\n\n\n### Part K\n\nUnder this new causal model, what is the minimal sufficient set of variables we need to control in order to causally identify the effect of `cigs` on `bwght`?\n\nYou can answer this using `dagitty.net,` and/or R.\n\n\n### Part L\n\nEstimate the causal effect in this new model by running the appropriate regression in `R`. Compare your answers to those in part F.\n\n\n### Part M\n\nTry out drawing this model using the `ggdag` package in R. See my DAG in question 3 for an example.\n",
    "supporting": [
      "04-problem-set_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}