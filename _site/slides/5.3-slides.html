<!DOCTYPE html>
<html lang="en"><head>
<script src="5.3-slides_files/libs/clipboard/clipboard.min.js"></script>
<script src="5.3-slides_files/libs/quarto-html/tabby.min.js"></script>
<script src="5.3-slides_files/libs/quarto-html/popper.min.js"></script>
<script src="5.3-slides_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="5.3-slides_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="5.3-slides_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="5.3-slides_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.0.37">

  <title>slides</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="5.3-slides_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="5.3-slides_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="5.3-slides_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="5.3-slides_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="5.3-slides_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="5.3-slides_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="5.3-slides_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="5.3-slides_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="5.3-slides_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  
  <script src="5.3-slides_files/libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="5.3-slides_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
  <link href="5.3-slides_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
  <script src="5.3-slides_files/libs/pagedtable-1.1/js/pagedtable.js"></script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section id="section" class="slide level2" data-menu-title="Title Slide" data-background-image="images/metrics_title_slide.png">
<h2></h2>
<p><span class="custom-title">5.3 — Instrumental Variables</span></p>
<p><span class="custom-subtitle">ECON 480 • Econometrics • Fall 2022</span></p>
<p><span class="custom-author">Dr.&nbsp;Ryan Safner <br> Associate Professor of Economics</span></p>
<p><span class="custom-institution"><a href="mailto:safner@hood.edu"><i class="fa fa-paper-plane fa-fw"></i>safner@hood.edu</a> <br> <a href="https://github.com/ryansafner/metricsF22"><i class="fa fa-github fa-fw"></i>ryansafner/metricsF22</a><br> <a href="https://metricsF22.classes.ryansafner.com"> <i class="fa fa-globe fa-fw"></i>metricsF22.classes.ryansafner.com</a><br></span></p>
</section>
<section id="contents" class="slide level2" data-background-color="#314f4f">
<h2>Contents</h2>
<h3 id="instrumental-variables-models"><a href="#/instrumental-variables-models">Instrumental Variables Models</a></h3>
<h3 id="two-stage-least-squares"><a href="#/two-stage-least-squares-2sls">Two Stage Least Squares</a></h3>
<h3 id="simultaneous-causation-structural-equation-modeling"><a href="#/simultaneous-causation-structural-equation-modeling">Simultaneous Causation &amp; Structural Equation Modeling</a></h3>
</section>
<section id="clever-research-designs-identify-causality" class="slide level2">
<h2>Clever Research Designs Identify Causality</h2>
<p>Again, <strong>this toolkit</strong> of research designs to <strong>identify causal effects</strong> is the economist’s <strong>comparative advantage</strong> that firms and governments want!</p>

<img data-src="5.3-slides_files/figure-revealjs/unnamed-chunk-2-1.png" width="1344" class="r-stretch quarto-figure-center"></section>
<section id="identification-strategies" class="slide level2">
<h2>Identification Strategies</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p><span class="hi-purple">Endogeneity</span> remains the hardest (and most common) econometric challenge</p></li>
<li><p>Diff-n-diff/fixed effects are one strategy to minimize endogeneity</p>
<ul>
<li><em>Requires</em> panel data</li>
<li>Can’t use time-varying omitted variables that are correlated with regressors</li>
</ul></li>
<li><p>Another strategy to is to find some source of exogenous variation that removes the endogeneity of a variable, using that source as a <span class="hi">instrumental variable</span></p></li>
</ul>
</div><div class="column" style="width:50%;">

</div>
</div>
</section>
<section id="identification-strategies-1" class="slide level2">
<h2>Identification Strategies</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p><span class="hi-purple">Endogeneity</span> remains the hardest (and most common) econometric challenge</p></li>
<li><p>Diff-n-diff/fixed effects are one strategy to minimize endogeneity</p>
<ul>
<li><em>Requires</em> panel data</li>
<li>Can’t use time-varying omitted variables that are correlated with regressors</li>
</ul></li>
<li><p>Another strategy to is to find some source of exogenous variation that removes the endogeneity of a variable, using that source as a <span class="hi">instrumental variable</span></p></li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="images/ivhot.jpg"></p>
</div>
</div>
</section>
<section>
<section id="instrumental-variables-models-1" class="title-slide slide level1 centered center" data-background-color="#314f4f">
<h1>Instrumental Variables Models</h1>

</section>
<section id="understanding-instruments" class="slide level2">
<h2>Understanding Instruments</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="5.3-slides_files/figure-revealjs/unnamed-chunk-3-1.png" width="960"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li><p><span class="red"><strong>X</strong></span> and <span class="red"><strong>Y</strong></span> are correlated</p></li>
<li><p>Consider confounding variable <span class="red"><strong>Z</strong></span> that would meet the conditions of omitted variable bias:</p>
<ol type="1">
<li>Causes <span class="math inline">\(Y\)</span> (in error term <span class="math inline">\(u)\)</span></li>
<li>Correlated with <span class="math inline">\(X\)</span></li>
</ol></li>
<li><p>Causal pathways from <span class="math inline">\(X\)</span> to <span class="math inline">\(Y\)</span>:</p>
<ol type="1">
<li><span class="math inline">\(X \rightarrow Y\)</span> (causal, front door)</li>
<li><span class="math inline">\(X \leftarrow Z \rightarrow Y\)</span> (non-causal, back door)</li>
</ol></li>
<li><p>Consider variable <span class="blue"><strong>I</strong></span> which causes <span class="red"><strong>X</strong></span> but <em>not</em> <span class="red"><strong>Y</strong></span></p></li>
</ul>
</div>
</div>
</section>
<section id="understanding-instruments-1" class="slide level2">
<h2>Understanding Instruments</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="5.3-slides_files/figure-revealjs/unnamed-chunk-4-1.png" width="960"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li><p>Variable <span class="blue"><strong>I</strong></span> has no backdoors between it and <span class="math inline">\(Y\)</span></p></li>
<li><p>The only way to reach <span class="math inline">\(Y\)</span> from <span class="math inline">\(I\)</span> is through <span class="math inline">\(X\)</span>:</p>
<ul>
<li><span class="math inline">\(I \rightarrow X \rightarrow Y\)</span></li>
</ul></li>
<li><p>Variable <span class="blue"><strong>I</strong></span> is a good <span class="hi">instrument</span> for <span class="math inline">\(X\)</span> if it satisfies two conditions:</p>
<ol type="1">
<li><span class="hi-purple">Inclusion condition</span>: <span class="math inline">\(I\)</span> statistically-significantly explains <span class="math inline">\(X\)</span></li>
<li><span class="hi-purple">Exclusion condition</span>: <span class="math inline">\(I\)</span> is uncorrelated with <span class="math inline">\(u\)</span>, so it does not directly affect <span class="math inline">\(Y\)</span></li>
</ol>
<ul>
<li><span class="math inline">\(I\)</span> only affects <span class="math inline">\(Y\)</span> <em>through</em> its effect on <span class="math inline">\(X\)</span></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="example-i-veterans-earnings" class="slide level2">
<h2>Example I: Veterans’ Earnings</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example</strong></p>
</div>
<div class="callout-content">
<p>How does veteran status affect lifetime earnings?</p>
</div>
</div>
</div>
<p><span class="math display">\[\text{Earnings}_{i}=\beta_0+\beta_1 \, \text{Veteran}_{i}+\text{u}_{i}\]</span></p>
<ul>
<li><span class="math inline">\(\text{Veteran}_i\)</span> is endogenous, correlated with other things in <span class="math inline">\(u_i\)</span>
<ul>
<li>Choice to enlist in military for non-random reasons</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="images/veteranhat.jpg"></p>
</div>
</div>
</section>
<section id="example-i-exogeneous-and-endogenous-variation" class="slide level2">
<h2>Example I: Exogeneous and Endogenous Variation</h2>
<ul>
<li>Imagine if we could split variation in <span class="math inline">\(\text{Veteran}_i\)</span> into an <span class="blue">exogenous</span> part and an <span class="red">endogenous</span> part:</li>
</ul>
<div class="fragment">
<p><span class="math display">\[\begin{align*}
\color{green}{\text{Earnings}_i} &amp;= \beta_0 + \beta_1 \, \color{red}{\text{Veteran}_i} + u_i \\
\end{align*}\]</span></p>
</div>
</section>
<section id="example-i-exogeneous-and-endogenous-variation-1" class="slide level2">
<h2>Example I: Exogeneous and Endogenous Variation</h2>
<ul>
<li>Imagine if we could split variation in <span class="math inline">\(\text{Veteran}_i\)</span> into an <span class="blue">exogenous</span> part and an <span class="red">endogenous</span> part:</li>
</ul>
<p><span class="math display">\[\begin{align*}
\color{green}{\text{Earnings}_i} &amp;= \beta_0 + \beta_1 \, \color{red}{\text{Veteran}_i} + u_i \\
\color{green}{\text{Earnings}_i} &amp;= \beta_0 + \beta_1 \,  (\color{blue}{\text{Veteran}_i^{Ex.}}+\color{red}{\text{Veteran}_i^{End.}})+u_i\\
\end{align*}\]</span></p>
</section>
<section id="example-i-exogeneous-and-endogenous-variation-2" class="slide level2">
<h2>Example I: Exogeneous and Endogenous Variation</h2>
<ul>
<li>Imagine if we could split variation in <span class="math inline">\(\text{Veteran}_i\)</span> into an <span class="blue">exogenous</span> part and an <span class="red">endogenous</span> part:</li>
</ul>
<p><span class="math display">\[\begin{align*}
\color{green}{\text{Earnings}_i} &amp;= \beta_0 + \beta_1 \, \color{red}{\text{Veteran}_i} + u_i \\
\color{green}{\text{Earnings}_i} &amp;= \beta_0 + \beta_1 \,  (\color{blue}{\text{Veteran}_i^{Ex.}}+\color{red}{\text{Veteran}_i^{End.}})+u_i\\
\color{green}{\text{Earnings}_i} &amp;= \beta_0 + \beta_1 \, \color{blue}{\text{Veteran}_i^{Ex.}}+ \underbrace{\beta_1 \color{red}{\text{Veteran}_i^{End.}}+u_i}_{w_i}\\
\end{align*}\]</span></p>
</section>
<section id="example-i-exogeneous-and-endogenous-variation-3" class="slide level2">
<h2>Example I: Exogeneous and Endogenous Variation</h2>
<ul>
<li>Imagine if we could split variation in <span class="math inline">\(\text{Veteran}_i\)</span> into an <span class="blue">exogenous</span> part and an <span class="red">endogenous</span> part:</li>
</ul>
<p><span class="math display">\[\begin{align*}
\color{green}{\text{Earnings}_i} &amp;= \beta_0 + \beta_1 \, \color{red}{\text{Veteran}_i} + u_i \\
\color{green}{\text{Earnings}_i} &amp;= \beta_0 + \beta_1 \,  (\color{blue}{\text{Veteran}_i^{Ex.}}+\color{red}{\text{Veteran}_i^{End.}})+u_i\\
\color{green}{\text{Earnings}_i} &amp;= \beta_0 + \beta_1 \, \color{blue}{\text{Veteran}_i^{Ex.}}+ \underbrace{\beta_1 \color{red}{\text{Veteran}_i^{End.}}+u_i}_{w_i}\\
\color{green}{\text{Earnings}_i} &amp;= \beta_0 + \beta_1 \, \color{blue}{\text{Veteran}_i^{Ex.}}+ w_i\\
\end{align*}\]</span></p>
<div class="fragment">
<ul>
<li>What would a plausible source of <span class="math inline">\(\color{blue}{\text{Veteran}_i^{Ex.}}\)</span> be?</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Choices to enlist in the military for “random” reasons, uncorrelated with <span class="math inline">\(u_i\)</span> (other things that affect Earnings<span class="math inline">\(_i)\)</span></li>
</ul>
</div>
</section>
<section id="inclusion-exclusion-conditions-for-instruments" class="slide level2">
<h2>Inclusion &amp; Exclusion Conditions for Instruments</h2>
<ul>
<li>We isolate the <em>exogenous variation</em> in <span class="math inline">\(X_i\)</span> with an <span class="hi">instrumental variable</span> that is:</li>
</ul>
<ol type="1">
<li>Correlated with the explanatory variable (<span class="hi-purple">relevance</span>)
<ul>
<li>Often called the <span class="hi-purple">“inclusion condition”</span></li>
</ul></li>
<li>Uncorrelated with the error term (<span class="hi-purple">exogenous</span>)
<ul>
<li>Often called the <span class="hi-purple">“exclusion condition”</span></li>
</ul></li>
</ol>
<div class="fragment">
<ul>
<li>So for our example:</li>
</ul>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p><span class="math display">\[\text{Earnings}_{i}=\beta_0+\beta_1 \, \text{Veteran}_{i}+\text{u}_{i}\]</span></p>
<p>We want an instrument <span class="math inline">\(I\)</span> for Veteran<span class="math inline">\(_i\)</span> which is:</p>
<ol type="1">
<li><span class="hi-purple">Relevant:</span> <span class="math inline">\(cor(Veteran_i, I)\neq 0\)</span></li>
<li><span class="hi-purple">Exogenous:</span> <span class="math inline">\(cor(I, u_i)\neq 0\)</span></li>
</ol>
</div>
</div>
</div>
</div>
</section>
<section id="example-instrument-relevance" class="slide level2">
<h2>Example Instrument: Relevance</h2>
<ul>
<li><p><span class="hi-purple">Relevance (“inclusion condition”)</span>: we need <span class="math inline">\(I\)</span> to vary with our endogenous <span class="math inline">\(X\)</span> variable</p></li>
<li><p>We can <em>test</em> this condition using a regression and <span class="math inline">\(t\)</span>-test on the relevant coefficient (checking correlations also helps)</p></li>
</ul>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example</strong></p>
</div>
<div class="callout-content">
<p>For <span class="math inline">\(\text{Veteran}_i\)</span> status, consider several potential <span class="math inline">\(I\)</span> variables:</p>
</div>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li>Social security number</li>
</ol>
</div><div class="column" style="width:50%;">
<p><strong>Probably not relevant</strong> <br> uncorrelated with military service</p>
</div>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<ol start="2" type="1">
<li>Physical fitness</li>
</ol>
</div><div class="column" style="width:50%;">
<p><strong>Possibly relevant</strong> <br> may be correlated with military service</p>
</div>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<ol start="3" type="1">
<li>Vietnam War Draft</li>
</ol>
</div><div class="column" style="width:50%;">
<p><strong>Relevant</strong> <br> being drawn in draft causes military service</p>
</div>
</div>
</div>
</section>
<section id="example-instrument-exogeneity" class="slide level2">
<h2>Example Instrument: Exogeneity</h2>
<ul>
<li><p><span class="hi-purple">Exogeneity (“exclusion condition”)</span> we need <span class="math inline">\(I\)</span> to be “as good as randomly assigned”, uncorrelated with <span class="math inline">\(u\)</span> (other factors that determine <span class="math inline">\(Y)\)</span></p></li>
<li><p><strong>This is not testable!</strong> (Need a good argument from theory/intuition)</p>
<ul>
<li>Does <span class="math inline">\(I\)</span> <em>only</em> affect <span class="math inline">\(Y\)</span> through <span class="math inline">\(X\)</span>?</li>
</ul></li>
</ul>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example</strong></p>
</div>
<div class="callout-content">
<p>For <span class="math inline">\(\text{Veteran}_i\)</span> status, consider several potential <span class="math inline">\(I\)</span> variables:</p>
</div>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li>Social security number</li>
</ol>
</div><div class="column" style="width:50%;">
<p><strong>Exogenous</strong> <br> uncorrelated with other factors of earnings</p>
</div>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<ol start="2" type="1">
<li>Physical fitness</li>
</ol>
</div><div class="column" style="width:50%;">
<p><strong>Not exogeous</strong> <br> correlated with many other factors of earnings</p>
</div>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<ol start="3" type="1">
<li>Vietnam War draft</li>
</ol>
</div><div class="column" style="width:50%;">
<p><strong>Exogenous</strong> <br> lottery was random!</p>
</div>
</div>
</div>
</section>
<section id="exogeneity-the-huh-factor" class="slide level2">
<h2>Exogeneity: The “Huh?” Factor</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p><img data-src="images/mixtape.jpg"></p>
</div><div class="column" style="width:70%;">
<blockquote>
<p>“A necessary but not a sufficient condition for having an instrument that can satisfy the exclusion restriction is if people are confused when you tell them about the instrument’s relationship to the outcome,” (p.123).</p>
</blockquote>
<p><span class="source">Cunningham, Scott, 2021, <a href="https://mixtape.scunning.com/07-instrumental_variables"><em>Causal Inference: The Mixtape</em></a></span></p>
</div>
</div>
</section>
<section id="good-instruments-are-hard-to-find-and-weird-i" class="slide level2 smaller">
<h2>Good Instruments are Hard to Find (And Weird) I</h2>
<table>
<colgroup>
<col style="width: 20%">
<col style="width: 18%">
<col style="width: 34%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>Outcome</th>
<th>Endogenous Variable</th>
<th>Unobservables</th>
<th>Instrument</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Income</td>
<td>Education</td>
<td>Ability</td>
<td>Quarter of birth</td>
</tr>
<tr class="even">
<td>Income</td>
<td>Education</td>
<td>Ability</td>
<td>Father’s education</td>
</tr>
<tr class="odd">
<td>Income</td>
<td>Education</td>
<td>Ability</td>
<td>Distance to college</td>
</tr>
<tr class="even">
<td>Income</td>
<td>Education</td>
<td>Ability</td>
<td>Military draft</td>
</tr>
<tr class="odd">
<td>Health</td>
<td>Smoking</td>
<td>Other negative health behaviors</td>
<td>Tobacco taxes</td>
</tr>
<tr class="even">
<td>Crime rates</td>
<td>Patrol hours</td>
<td>number of criminals</td>
<td>Election cycles</td>
</tr>
<tr class="odd">
<td>Crime rates</td>
<td>Patrol hours</td>
<td>number of criminals</td>
<td>Firefighters</td>
</tr>
<tr class="even">
<td>Crime rates</td>
<td>Patrol hours</td>
<td>number of criminals</td>
<td>Terror Alert levels</td>
</tr>
<tr class="odd">
<td>Crime rates</td>
<td>Incarceration rates</td>
<td>Simultaneous causality</td>
<td>Overcrowding litigations</td>
</tr>
<tr class="even">
<td>Labor market success</td>
<td>Americanization</td>
<td>Ability</td>
<td>Scrabble score of name</td>
</tr>
<tr class="odd">
<td>Conflict</td>
<td>Economic growth</td>
<td>Simultaneous causality</td>
<td>Rainfall</td>
</tr>
</tbody>
</table>
</section>
<section id="good-instruments-are-hard-to-find-and-weird-ii" class="slide level2">
<h2>Good Instruments are Hard to Find (And Weird) II</h2>

<img data-src="images/iv_examples.png" class="r-stretch quarto-figure-center"><p><span class="source">Angrist, Joshua D and Alan B Kreuger, 2001, “Instrumental Variables and the Search for Identification: From Supply and Demand to Natural Experiments,” <em>Journal of Economic Perspectives</em> 15(4): 69-85</span></p>
</section>
<section id="exogeneity-the-huh-factor-1" class="slide level2">
<h2>Exogeneity: The “Huh?” Factor</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p><img data-src="images/mixtape.jpg"></p>
</div><div class="column" style="width:70%;">
<blockquote>
<p>“Remember what I said about how instruments having a certain ridiculousness to them? That is, you know you have a good instrument if the instrument itself doesn’t seem relevant for explaining the outcome of interest because <em>that’s what the exclusion restriction implies.</em> Why would quarter of birth affect earnings? It doesn’t make any obvious, logical sense why it should. But, if I told you that people born later in the year got more schooling than those with less <em>because of compulsory schooling,</em> then the relationship between the instrument and the outcome snaps into place. The only reason we can think of as to why the instrument would affect earnings is if the instrument were operating through schooling. Instruments only explain the outcome, in other words, when you understand their effect on the endogenous variable,” (p.123).</p>
</blockquote>
<p><span class="source">Cunningham, Scott, 2021, <a href="https://mixtape.scunning.com/07-instrumental_variables"><em>Causal Inference: The Mixtape</em></a></span></p>
</div>
</div>
</section>
<section id="good-instruments-are-hard-to-find-and-weird-iii" class="slide level2">
<h2>Good Instruments are Hard to Find (And Weird) III</h2>

<img data-src="images/rain-paper.png" class="r-stretch"></section>
<section id="testing-the-exclusion-restriction" class="slide level2">
<h2>“Testing” the Exclusion Restriction</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="5.3-slides_files/figure-revealjs/unnamed-chunk-5-1.png" width="960"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>Can you argue that the instrument does <strong>not</strong> affect outcome <span class="math inline">\(Y\)</span> <strong>except only</strong> through <span class="math inline">\(X\)</span>?</li>
</ul>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Examples</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Instrument <span class="math inline">\(\rightarrow\)</span> ? <span class="math inline">\(\rightarrow\)</span> outcome</li>
<li>Quarter of birth <span class="math inline">\(\rightarrow\)</span> ? <span class="math inline">\(\rightarrow\)</span> wages</li>
<li>Rainfall <span class="math inline">\(\rightarrow\)</span> ? <span class="math inline">\(\rightarrow\)</span> civil war</li>
<li>Scrabble score of name <span class="math inline">\(\rightarrow\)</span> ? <span class="math inline">\(\rightarrow\)</span> wages</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="example-review" class="slide level2 smaller">
<h2>Example: Review</h2>
<ul>
<li>Instrument must be
<ol type="1">
<li>Correlated with our endogenous variable <span class="math inline">\((X_i)\)</span> (inclusion restriction)</li>
<li>Uncorrelated with omitted variables that affect <span class="math inline">\(Y_i\)</span> (exclusion restriction)</li>
</ol></li>
<li>To summarize: <strong>the instrument <u>only</u> affects the outcome through its relationship with the endogenous variable</strong></li>
</ul>
<div class="fragment">
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example</strong></p>
</div>
<div class="callout-content">
<p>For <span class="math inline">\(\text{Veteran}_i\)</span> status, our several potential <span class="math inline">\(I\)</span> variables:</p>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li>Social security number:</li>
</ol>
</div><div class="column" style="width:50%;">
<p><strong>Not relevant</strong> <br> <strong>Exogenous</strong></p>
</div>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<ol start="2" type="1">
<li>Physical fitness:</li>
</ol>
</div><div class="column" style="width:50%;">
<p><strong>Relevant</strong> <br> <strong>Not exogenous</strong></p>
</div>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<ol start="3" type="1">
<li>Vietnam War Draft:</li>
</ol>
</div><div class="column" style="width:50%;">
<p><strong>Relevant</strong> <br> <strong>Exogenous</strong></p>
</div>
</div>
<ul>
<li>The Vietnam War Draft is the only <strong><em>valid</em> instrument</strong></li>
</ul>
</div>
</section>
<section id="example-i-dag-form" class="slide level2">
<h2>Example I: DAG Form</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="5.3-slides_files/figure-revealjs/unnamed-chunk-6-1.png" width="960"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>Causal pathways from <span class="math inline">\(X\)</span> to <span class="math inline">\(Y\)</span>:
<ol type="1">
<li><span class="math inline">\(\color{red}{Vet} \rightarrow \color{green}{Earn}\)</span></li>
<li><span class="math inline">\(\color{red}{Vet} \leftarrow \color{blue}{U} \rightarrow \color{green}{Earn}\)</span></li>
</ol></li>
<li>We want the causal effect of</li>
</ul>
<p><span class="math display">\[\color{red}{Vet} \rightarrow \color{green}{Earn}\]</span></p>
<ul>
<li>With our instrument</li>
</ul>
<p><span class="math display">\[\color{blue}{Draft} \rightarrow \color{red}{Vet} \rightarrow \color{green}{Earn}\]</span></p>
</div>
</div>
</section>
<section id="example-i-dag-form-1" class="slide level2 smaller">
<h2>Example I: DAG Form</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="5.3-slides_files/figure-revealjs/unnamed-chunk-7-1.png" width="960"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>With our instrument</li>
</ul>
<p><span class="math display">\[\color{blue}{Draft} \rightarrow \color{red}{Vet} \rightarrow \color{green}{Earn}\]</span></p>
<ul>
<li>Based on our assumptions on independence and exogeneity:</li>
</ul>
<p>(Effect of <span class="blue">draft</span> on <span class="green">earnings</span>) <span class="math inline">\(=\)</span> <br>(Effect of <span class="blue">draft</span> on <span class="red">veteran</span>) <span class="math inline">\(\times\)</span> (Effect of <span class="red">veteran</span> on <span class="green">earnings</span>)</p>
</div>
</div>
</section>
<section id="example-i-dag-form-2" class="slide level2 smaller">
<h2>Example I: DAG Form</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="5.3-slides_files/figure-revealjs/unnamed-chunk-8-1.png" width="960"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>With our instrument</li>
</ul>
<p><span class="math display">\[\color{blue}{Draft} \rightarrow \color{red}{Vet} \rightarrow \color{green}{Earn}\]</span></p>
<ul>
<li>Based on our assumptions on independence and exogeneity:</li>
</ul>
<p>(Effect of <span class="blue">draft</span> on <span class="green">earnings</span>) <span class="math inline">\(=\)</span> <br> (Effect of <span class="blue">draft</span> on <span class="red">veteran</span>) <span class="math inline">\(\times\)</span> (Effect of <span class="red">veteran</span> on <span class="green">earnings</span>)</p>
<ul>
<li>To find effect of <span class="red">veteran</span> on <span class="green">earnings</span>, rearrange!</li>
</ul>
<p>(Effect of <span class="red">veteran</span> on <span class="green">earnings</span>) <span class="math inline">\(=\)</span> <br>(Effect of <span class="blue">draft</span> on <span class="green">earnings</span>) <br> <span class="bottom">(Effect of <span class="blue">draft</span> on <span class="red">veteran</span>)</span></p>
</div>
</div>
</section>
<section id="estimating-the-effect-with-instrumental-variables" class="slide level2 smaller">
<h2>Estimating The Effect With Instrumental Variables</h2>
<p><em>Recall:</em> We want to estimate the effect of veteran status on earnings.</p>
<p><span class="math display">\[\color{green}{\text{Earnings}_i} = \beta_0 + \beta_1 \,  \color{red}{\text{Veteran}_i} + u_i\]</span></p>
<div class="fragment">
<ul>
<li>Consider two other relationships:</li>
</ul>
</div>
<div class="fragment">
<ol type="1">
<li>Effect of <span class="blue">instrument</span> on the <span class="red">endogenous variable</span></li>
</ol>
<p><span class="math display">\[\color{red}{\text{Veteran}_i} = \gamma_0 + \mathbf{\gamma_1} \, \color{blue}{\text{Draft}_i} + w_i\]</span></p>
</div>
<div class="fragment">
<ol start="2" type="1">
<li>Effect of <span class="blue">instrument</span> on the <span class="green">outcome variable</span> (<span class="hi">“reduced form”</span>)</li>
</ol>
<p><span class="math display">\[
\color{green}{\text{Earnings}_i} = \pi_0 + \mathbf{\pi_1} \color{blue}{\text{Draft}_i} + v_i
\]</span></p>
</div>
<div class="fragment">
<ul>
<li>Using these, we can estimate our desired effect, (Effect of <span class="red">veteran status</span> on <span class="green">earnings</span>):</li>
</ul>
<p><span class="math display">\[\beta_1^{IV}= \frac{\pi_1}{\gamma_1}\]</span></p>
</div>
</section>
<section id="estimating-the-effect-with-instrumental-variables-1" class="slide level2">
<h2>Estimating The Effect With Instrumental Variables</h2>
<ul>
<li>With our instrument, we estimate <span class="math inline">\(\beta_1\)</span> using</li>
</ul>
<p><span class="math display">\[\hat{\beta}_1^{IV}= \frac{\hat{\mathbf{\pi}}_1}{\hat{\mathbf{\gamma}}_1}\]</span></p>
<p>where <span class="math inline">\(\hat{\pi}_1\)</span> and <span class="math inline">\(\hat{\gamma}_1\)</span> come from the regressions in the last slide</p>
<div class="fragment">
<ul>
<li>Is this estimator unbiased?</li>
</ul>
</div>
<div class="fragment">
<p><span class="math display">\[\mathbb{E}[\hat{\beta}_1^{IV}] = \beta_1 + \frac{\text{cov}(\color{blue}{Instrument}, u)}{\text{cov}(\color{blue}{\text{Instrument}}, \color{red}{\text{Endog. variable}})}\]</span></p>
</div>
<div class="fragment">
<ul>
<li>Yes: so long as the <span class="blue">instrument</span> is <strong>valid</strong>, i.e.&nbsp;<span class="hi-purple">exogenous</span> (numerator) and <span class="hi-purple">relevant</span> (denominator)</li>
</ul>
</div>
</section>
<section id="example-education" class="slide level2">
<h2>Example: Education</h2>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example</strong></p>
</div>
<div class="callout-content">
<p>Consider the age-old question of how education affects wages.</p>
</div>
</div>
</div>
<div class="fragment">
<p><span class="math display">\[\text{wage}_i = \beta_0 + \beta_1 \, \text{education}_i + u_i\]</span></p>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>ols_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(wage <span class="sc">~</span> education, <span class="at">data =</span> wage_df)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">tidy</span>(ols_reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"176.50395","3":"89.151950","4":"1.979810","5":"4.810523e-02"},{"1":"education","2":"58.59393","3":"6.439262","4":"9.099479","5":"8.755353e-19"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li><code>education</code> is endogenous</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>What if we use <code>mother's education</code> as an instrument?</li>
</ul>
</div>
</section>
<section id="example-instrument" class="slide level2">
<h2>Example: Instrument</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="5.3-slides_files/figure-revealjs/unnamed-chunk-11-1.png" width="960"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>Causal pathways from <span class="math inline">\(educ\)</span> to <span class="math inline">\(wage\)</span>:
<ol type="1">
<li><span class="math inline">\(\color{red}{educ} \rightarrow \color{green}{wage}\)</span></li>
<li><span class="math inline">\(\color{red}{educ} \leftarrow \color{blue}{U} \rightarrow \color{green}{wage}\)</span></li>
</ol></li>
<li>We want the causal effect of</li>
</ul>
<p><span class="math display">\[\color{red}{educ} \rightarrow \color{green}{wage}\]</span></p>
<ul>
<li>With our instrument</li>
</ul>
<p><span class="math display">\[\color{blue}{mom} \rightarrow \color{red}{educ} \rightarrow \color{green}{wage}\]</span></p>
</div>
</div>
</section>
<section id="example-relevance" class="slide level2">
<h2>Example: Relevance</h2>
<ul>
<li><p>We can check the <span class="hi">relevance</span> of <span class="blue">mother’s education</span> as an instrument for <span class="red">education</span></p></li>
<li><p>This regression is known as the <span class="hi">“first stage”</span>: effect of the <span class="blue">instrument</span> on the <span class="red">endogenous variable</span></p></li>
</ul>
<p><span class="math display">\[\color{red}{\text{Education}_i}=\gamma_0 + \gamma_1 \color{blue}{\text{Mother's education}_i} + v_i\]</span></p>
<div class="fragment">
<div class="cell" data-output-locaion="fragment">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>first_stage <span class="ot">&lt;-</span> <span class="fu">lm</span>(education <span class="sc">~</span> education_mom, <span class="at">data =</span> wage_df)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">tidy</span>(first_stage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"10.4867466","3":"0.30557465","4":"34.31812","5":"1.125629e-153"},{"1":"education_mom","2":"0.2939719","3":"0.02735751","4":"10.74557","5":"4.408584e-25"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li><span class="math inline">\(p\)</span>-value suggests this is a very relevant instrument!</li>
</ul>
</div>
</section>
<section id="first-stage-visualized" class="slide level2">
<h2>First-Stage Visualized</h2>

<img data-src="5.3-slides_files/figure-revealjs/unnamed-chunk-13-1.png" width="960" class="r-stretch"></section>
<section id="exogeneity" class="slide level2">
<h2>Exogeneity</h2>
<ul>
<li>We need our instrument, <span class="blue">mother’s education</span> to be <span class="hi">exogenous</span></li>
</ul>
<ol type="1">
<li><span class="blue">Mother’s education</span> must only affect <span class="green">wages</span> through <span class="red">(own) education</span></li>
<li><span class="blue">Mother’s education</span> must be uncorrelated with other factors that affect <span class="green">wages</span> (i.e.&nbsp;the error term <span class="math inline">\(u_i\)</span>)</li>
</ol>
<div class="fragment">
<ul>
<li>We want to be able to compare two individuals <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> whose mothers have different levels of education and say their <em>only differences</em> between <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are their mothers’ education levels.</li>
</ul>
</div>
</section>
<section id="reduced-form" class="slide level2">
<h2>Reduced Form</h2>
<ul>
<li>The estimate for the <span class="hi">reduced form</span> (effect of <span class="blue">instrument</span> on <span class="green">outcome</span>)</li>
</ul>
<p><span class="math display">\[
\color{green}{\text{Wage}_i} = \pi_0 + \mathbf{\pi_1} \color{blue}{\text{Mother's education}_i} + v_i
\]</span></p>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"633.33672","3":"58.577754","4":"10.81190","5":"2.369599e-25"},{"1":"education_mom","2":"31.81183","3":"5.244353","4":"6.06592","5":"2.118840e-09"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</section>
<section id="the-effect-were-after" class="slide level2 smaller">
<h2>The Effect We’re After</h2>
<ul>
<li>So what’s our estimate of the returns to <span class="red">education</span> on <span class="green">wages</span></li>
</ul>
<p><span class="math display">\[\color{green}{\text{Wages}_i} = \beta_0 + \beta_1 \,  \color{red}{\text{Education}_i} + u_i\]</span></p>
<ul>
<li>We know the IV estimate for <span class="math inline">\(\beta_1\)</span> is</li>
</ul>
<p><span class="math display">\[\beta_1^{IV}= \frac{\pi_1}{\gamma_1}\]</span></p>
<div class="fragment">
<ol type="1">
<li>In the reduced form equation, we estimated <span class="math inline">\(\hat{\pi}_1 \approx 31.81\)</span></li>
</ol>
</div>
<div class="fragment">
<ol start="2" type="1">
<li>In the first-stage equation, we estimated <span class="math inline">\(\hat{\gamma}_1 \approx 0.294\)</span></li>
</ol>
</div>
<div class="fragment">
<p><span class="math display">\[\hat{\beta}_1^{IV}= \frac{\hat{\pi}_1}{\hat{\gamma}_1} \approx \frac{31.81}{0.294} \approx 108.2\]</span></p>
</div>
</section>
<section id="example-in-r-estimatr" class="slide level2 smaller">
<h2>Example in R: <code>estimatr</code></h2>
<ul>
<li><code>estimatr</code> package</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">library</span>(estimatr)</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>iv_reg <span class="ot">&lt;-</span> <span class="fu">iv_robust</span>(wage <span class="sc">~</span> education <span class="sc">|</span> education_mom, <span class="at">data =</span> wage_df)</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="fu">summary</span>(iv_reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
iv_robust(formula = wage ~ education | education_mom, data = wage_df)

Standard error type:  HC2 

Coefficients:
            Estimate Std. Error t value  Pr(&gt;|t|) CI Lower CI Upper  DF
(Intercept)   -501.5     226.48  -2.214 2.712e-02  -946.11   -56.84 720
education      108.2      16.81   6.437 2.220e-10    75.21   141.22 720

Multiple R-squared:  0.02917 ,  Adjusted R-squared:  0.02783 
F-statistic: 41.44 on 1 and 720 DF,  p-value: 2.22e-10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">tidy</span>(iv_reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["outcome"],"name":[9],"type":["chr"],"align":["left"]}],"data":[{"1":"(Intercept)","2":"-501.4743","3":"226.47608","4":"-2.214248","5":"2.712420e-02","6":"-946.10668","7":"-56.84191","8":"720","9":"wage"},{"1":"education","2":"108.2138","3":"16.81031","4":"6.437348","5":"2.219782e-10","6":"75.21074","7":"141.21692","8":"720","9":"wage"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="example-in-r-fixest" class="slide level2 smaller">
<h2>Example in R: <code>fixest</code></h2>
<ul>
<li><code>fixest</code> package</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a>iv_reg_2 <span class="ot">&lt;-</span> <span class="fu">feols</span>(wage <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> education <span class="sc">~</span> education_mom, <span class="at">data =</span> wage_df)</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="fu">summary</span>(iv_reg_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>TSLS estimation, Dep. Var.: wage, Endo.: education, Instr.: education_mom
Second stage: Dep. Var.: wage
Observations: 722 
Standard-errors: IID 
              Estimate Std. Error  t value   Pr(&gt;|t|)    
(Intercept)   -501.474   246.6842 -2.03286 4.2433e-02 *  
fit_education  108.214    18.0210  6.00486 3.0367e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 401.8   Adj. R2: 0.027825
F-test (1st stage), education: stat = 115.5    , p &lt; 2.2e-16 , on 1 and 720 DoF.
                   Wu-Hausman: stat =   9.63706, p = 0.001982, on 1 and 719 DoF.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">tidy</span>(iv_reg_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"-501.4743","3":"246.68425","4":"-2.032859","5":"4.243317e-02"},{"1":"fit_education","2":"108.2138","3":"18.02104","4":"6.004860","5":"3.036728e-09"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section></section>
<section>
<section id="two-stage-least-squares-2sls" class="title-slide slide level1 centered center" data-background-color="#314f4f">
<h1>Two-Stage Least Squares (2SLS)</h1>

</section>
<section id="instrumental-variables-2sls" class="slide level2">
<h2>Instrumental Variables &amp; 2SLS</h2>
<ul>
<li>Now we know how to use instruments (when there is <strong>1</strong> <span class="red">endogenous <span class="math inline">\(X\)</span> variable</span>, and <strong>1</strong> <span class="blue">instrumental variable <span class="math inline">\(I\)</span></span>):
<ol type="1">
<li>Estimate reduced form (regress <span class="green">outcome</span> <code>~</code> <span class="blue">instrument</span>)</li>
<li>Estimate first stage (regress <span class="red">endog. variable</span> <code>~</code> <span class="blue">instrument</span>)</li>
<li>Calculate IV-estimate of <span class="green">outcome</span> <code>~</code> <span class="red">endog. variable</span> using (1) and (2)</li>
</ol></li>
</ul>
<div class="fragment">
<ul>
<li><span class="blue">Instrument</span> isolates only the exogenous variation in the <span class="red">endogenous variable</span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>What if we want to use <strong>multiple</strong> endogenous variables and/or <strong>multiple</strong> instruments?</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Extend this approach using <span class="hi">two-stage least squares (2SLS)</span><sup>1</sup></li>
</ul>
</div>
<aside><ol class="aside-footnotes"><li id="fn1" role="doc-endnote"><p>In practice, since 2SLS is used so commonly, most people conflate instrumental variables approaches with 2SLS, but it is just <em>one</em> approach to using instruments.</p></li></ol></aside></section>
<section id="intuitions-from-instruments-2sls" class="slide level2">
<h2>Intuitions from Instruments &amp; 2SLS</h2>
<ul>
<li>We already have a lot of intuitions from IV to talk about 2SLS:</li>
</ul>
<p><span class="math display">\[\begin{align}
  {\color{#c5c5c5}{\text{Endogenous model}}}&amp; &amp;\color{green}{\text{Outcome}_i} &amp;= \beta_0 + \beta_1 \color{red}{\left( \text{Endog. var.} \right)_i} + u_i\\[0.5em]
  {\text{First stage}}&amp; &amp;\color{red}{\left( \text{Endog. var.} \right)_i} &amp;= \pi_0 + \pi_1 \color{blue}{\text{Instrument}_i} + v_i\\[0.25em]
  {\text{Second stage}}&amp; &amp;\color{green}{\text{Outcome}_i} &amp;= \delta_0 + \delta_1 \color{red}{\widehat{\left( \text{Endog. var.} \right)}_i} + \varepsilon_i\\[0.5em]
  {\color{#c5c5c5}{\text{Reduced form}}}&amp; &amp;\color{green}{\text{Outcome}_i} &amp;= \pi_0 + \pi_1 \color{blue}{\text{Instrument}_i} + w_i\\[0.25em]
\end{align}\]</span></p>
<p>where <span class="math inline">\(\color{red}{\widehat{\left( \text{Endog. var.} \right)}_i}\)</span> are the predicted values (<em>fitted values</em>) from the first-stage regression</p>
</section>
<section id="sls-advantages" class="slide level2">
<h2>2SLS: Advantages</h2>
<ul>
<li>2SLS is very flexible:
<ul>
<li>Can add additional endogenous variables</li>
<li>Can use additional instruments for endogenous variables</li>
<li>Can add additional (exogenous) control variables <span class="math inline">\((X_2, \cdots, X_k)\)</span></li>
</ul></li>
<li>Of course, your instruments still need to be <span class="hi">valid</span>:
<ol type="1">
<li>Exogenous</li>
<li>Relevant</li>
</ol></li>
</ul>
</section>
<section id="sls-multiple-instruments" class="slide level2 smaller">
<h2>2SLS: Multiple Instruments</h2>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example</strong></p>
</div>
<div class="callout-content">
<p>Come back to to our returns to education on wages example.</p>
<p><span class="math display">\[\text{wage}_i = \beta_0 + \beta_1 \, \text{education}_i + u_i\]</span></p>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>Suppose both <span class="blue">mother’s education</span> and <span class="blue">father’s education</span> are <strong>valid</strong> instruments (relevant and exogenous)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Then the <strong>first stage</strong> regression is:</li>
</ul>
<p><span class="math display">\[\color{red}{\text{Education}_i}=\gamma_0 + \gamma_1 \color{blue}{\text{Mother's education}_i} + \gamma_2 \color{blue}{\text{Father's education}_i} + v_i\]</span></p>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"9.8453600","3":"0.30470880","4":"32.310718","5":"3.586474e-142"},{"1":"education_mom","2":"0.1486908","3":"0.03215931","4":"4.623569","5":"4.471844e-06"},{"1":"education_dad","2":"0.2156354","3":"0.02751775","4":"7.836229","5":"1.672522e-14"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</section>
<section id="first-stage-checking-relevance" class="slide level2 smaller">
<h2>First Stage: Checking Relevance</h2>
<div class="cell">
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"9.8453600","3":"0.30470880","4":"32.310718","5":"3.586474e-142"},{"1":"education_mom","2":"0.1486908","3":"0.03215931","4":"4.623569","5":"4.471844e-06"},{"1":"education_dad","2":"0.2156354","3":"0.02751775","4":"7.836229","5":"1.672522e-14"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>Both instruments appear to be relevant (small <span class="math inline">\(p\)</span>-values), but we can more formally test their relevance <strong>jointly</strong> (i.e., an <span class="math inline">\(F\)</span>-test)</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">library</span>(car)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">linearHypothesis</span>(first_stage_multiple_IVs, <span class="fu">c</span>(<span class="st">"education_mom"</span>, <span class="st">"education_dad"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"721","2":"3607.215","3":"NA","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"719","2":"2864.067","3":"2","4":"743.1482","5":"93.28057","6":"9.596092e-37","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li><span class="math inline">\(p\)</span>-value is small, so they are jointly significant, i.e.&nbsp;relevant instruments</li>
</ul>
</div>
</section>
<section id="aside-the-problem-of-weak-instruments" class="slide level2">
<h2>Aside: The Problem of Weak Instruments</h2>
<ul>
<li><p><span class="hi">Weak instruments</span> have low relevance (i.e.&nbsp;<span class="math inline">\(\text{cor}(X,I)\)</span> is weak) and add little explanatory power</p></li>
<li><p>This can make OLS (and 2SLS) unreliable in small samples, and significantly raises the variance of OLS estimates</p></li>
<li><p>This likelihood also increases when we have multiple instruments, or more instruments than endogenous variables (a problem of <span class="hi-purple">“overidentification”</span>)</p></li>
</ul>
</section>
<section id="second-stage" class="slide level2">
<h2>Second-Stage</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># add fitted values from first stage</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>wage_df<span class="sc">$</span>education_hat <span class="ot">&lt;-</span> first_stage_multiple_IVs<span class="sc">$</span>fitted.values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<ul>
<li>Now run the <strong>second stage</strong> regression:</li>
</ul>
<p><span class="math display">\[\color{green}{\text{Wage}_i} = \delta_0 + \delta_1 \color{red}{\widehat{\left( \text{education} \right)}_i} + \varepsilon_i\]</span></p>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"-454.6828","3":"198.14948","4":"-2.294645","5":"2.204034e-02"},{"1":"education_hat","2":"104.7893","3":"14.46236","4":"7.245654","5":"1.110314e-12"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</section>
<section id="comparing-results" class="slide level2">
<h2>Comparing Results</h2>
<div class="cell">
<div class="cell-output-display">

<table style="NAborder-bottom: 0; width: auto !important; margin-left: auto; margin-right: auto;" class="table">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:center;"> OLS </th>
   <th style="text-align:center;"> IV </th>
   <th style="text-align:center;"> 2SLS (two instruments) </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Constant </td>
   <td style="text-align:center;"> 176.50** </td>
   <td style="text-align:center;"> −501.47** </td>
   <td style="text-align:center;"> −454.68** </td>
  </tr>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:center;"> (89.15) </td>
   <td style="text-align:center;"> (226.48) </td>
   <td style="text-align:center;"> (198.15) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> education </td>
   <td style="text-align:center;"> 58.59*** </td>
   <td style="text-align:center;"> 108.21*** </td>
   <td style="text-align:center;"> 104.79*** </td>
  </tr>
  <tr>
   <td style="text-align:left;box-shadow: 0px 1px">  </td>
   <td style="text-align:center;box-shadow: 0px 1px"> (6.44) </td>
   <td style="text-align:center;box-shadow: 0px 1px"> (16.81) </td>
   <td style="text-align:center;box-shadow: 0px 1px"> (14.46) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> n </td>
   <td style="text-align:center;"> 722 </td>
   <td style="text-align:center;"> 722 </td>
   <td style="text-align:center;"> 722 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Adj. R<sup>2</sup> </td>
   <td style="text-align:center;"> 0.10 </td>
   <td style="text-align:center;"> 0.03 </td>
   <td style="text-align:center;"> 0.07 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> SER </td>
   <td style="text-align:center;"> 386.21 </td>
   <td style="text-align:center;"> 401.82 </td>
   <td style="text-align:center;"> 393.71 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<sup></sup> * p &lt; 0.1, ** p &lt; 0.05, *** p &lt; 0.01</td></tr></tfoot>
</table>

</div>
</div>
</section>
<section id="using-estimatr-or-fixest" class="slide level2 smaller">
<h2>Using <code>estimatr</code> or <code>fixest</code></h2>
<ul>
<li><p>You can do this “by hand” as we did, but <code>R</code> packages will run both stages for you</p></li>
<li><p><code>estimatr</code> package: <code>iv_robust(y ~ x1 + x2 + ... | z1 + z2 + ..., data = df)</code></p>
<ul>
<li><code>x1</code>, <code>x2</code>, <code>...</code> are your endogenous variables</li>
<li><code>z1</code>, <code>z2</code>, <code>...</code> are instruments</li>
<li><code>df</code> is the dataframe</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">iv_robust</span>(wage <span class="sc">~</span> education <span class="sc">|</span> education_mom <span class="sc">+</span> education_dad, <span class="at">data =</span> wage_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error   t value     Pr(&gt;|t|)   CI Lower  CI Upper
(Intercept) -454.6828  199.94577 -2.274030 2.325766e-02 -847.22915 -62.13638
education    104.7893   14.85244  7.055357 4.051281e-12   75.62999 133.94851
             DF
(Intercept) 720
education   720</code></pre>
</div>
</div>
</section>
<section id="using-estimatr-or-fixest-1" class="slide level2 smaller">
<h2>Using <code>estimatr</code> or <code>fixest</code></h2>
<ul>
<li><code>fixest</code> package: <code>feols()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">feols</span>(wage <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> education <span class="sc">~</span> education_mom <span class="sc">+</span> education_dad, <span class="at">data =</span> wage_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>TSLS estimation, Dep. Var.: wage, Endo.: education, Instr.: education_mom, education_dad
Second stage: Dep. Var.: wage
Observations: 722 
Standard-errors: IID 
              Estimate Std. Error  t value   Pr(&gt;|t|)    
(Intercept)   -454.683   201.2012 -2.25984 2.4129e-02 *  
fit_education  104.789    14.6851  7.13576 2.3529e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 399.8   Adj. R2: 0.037696
F-test (1st stage), education: stat = 93.3     , p &lt; 2.2e-16 , on 2 and 719 DoF.
                   Wu-Hausman: stat = 13.6     , p = 2.448e-4, on 1 and 719 DoF.
                       Sargan: stat =  0.111147, p = 0.738842, on 1 DoF.</code></pre>
</div>
</div>
</section>
<section id="another-example-levitt-2002-i" class="slide level2">
<h2>Another Example: Levitt (2002) I</h2>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example</strong></p>
</div>
<div class="callout-content">
<p>How do police affect crime?</p>
</div>
</div>
</div>
<p><span class="math display">\[Crime_{it}=\beta_0+\beta_1 Police_{it}+u_{it}\]</span></p>
<div class="fragment">
<ul>
<li>Police<span class="math inline">\(\rightarrow\)</span>crime (more police reduces crime)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Crime<span class="math inline">\(\rightarrow\)</span>Police (high crime areas tend to have more police)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="math inline">\(cor(Police, \epsilon)\neq 0\)</span>: population, income per capita, drug use, recessions, demography, etc.</li>
</ul>
</div>
</section>
<section id="another-example-levitt-2002-ii" class="slide level2">
<h2>Another Example: Levitt (2002) II</h2>
<ul>
<li><p>Levitt (2002): use number of firefighters as an instrumental variable</p></li>
<li><p>Some police are hired for <strong>endogenous</strong> reasons (respond to crime, changes in economy, demographics, etc)</p></li>
<li><p>Some police are hired for <strong>exogenous</strong> reasons (city just gains a larger budget and so hires more police)</p>
<ul>
<li>These exogenous dynamics affect the number of firefighters in a city — <em>not</em> due to crime, but due to excess budgets, etc.</li>
</ul></li>
<li><p>Isolate that portion of variation in Police that covaries with Firefighters for those <strong>exogenous</strong> changes (i.e.&nbsp;for reasons <em>other</em> than crime or its causes), see how <em>these</em> changes in Police affect crime</p></li>
</ul>
<p><span class="source">Levitt, Steven D, (2002), “Using Electoral Cycles in Police Hiring to Estimate the Effect of Police on Crime: Reply,” <em>American Economic Review</em> 92(4): 1244-1250</span></p>
</section>
<section id="another-example-levitt-2002-iii" class="slide level2">
<h2>Another Example: Levitt (2002) III</h2>
<ul>
<li>Levitt’s (2002) paper, First Stage:</li>
</ul>
<p><span class="math display">\[ln(Police_{ct})=\gamma_1ln(Firefighters_{ct})+\alpha_c + \tau_t+ \gamma_2Controls_{ct}+\nu_{ct}\]</span></p>
<p>subscripts for city <span class="math inline">\(c\)</span> at year <span class="math inline">\(t\)</span>, two-way fixed effects: <span class="math inline">\(\alpha_c\)</span> city fixed-effects, <span class="math inline">\(\tau_t\)</span> year fixed-effects</p>
<div class="fragment">
<ul>
<li>Second stage:</li>
</ul>
<p><span class="math display">\[\widehat{ln(Crime_{ct})}=\beta_1 \widehat{ln(Police_{c{t-1}})}+\alpha_c + \tau_t+\beta_2 Controls_{ct}+\epsilon_{ct}  \]</span></p>
<p>lag for police (last year’s police force determines this year’s crime rates)</p>
</div>
</section>
<section id="another-example-levitt-2002-iv" class="slide level2">
<h2>Another Example: Levitt (2002) IV</h2>

<img data-src="images/levitt2002a.png" class="r-stretch quarto-figure-center"><div class="fragment">
<p>Instrument is statistically significant (<span class="math inline">\(t \approx 5\)</span>), inclusion condition met</p>
<p>A 1% increase in firefighters is associated with a 0.206-0.251% increase in police</p>
</div>
</section>
<section id="another-example-levitt-2002-v" class="slide level2">
<h2>Another Example: Levitt (2002) V</h2>

<img data-src="images/levitt2002b.png" class="r-stretch quarto-figure-center"><p>A 1% increase in police (last year) leads to a 0.435% decrease in violent crimes, 0.501% decrease in property crimes</p>
</section>
<section id="another-example-ajr-2001-i" class="slide level2">
<h2>Another Example: AJR (2001) I</h2>

<img data-src="images/europeanempires.png" class="r-stretch quarto-figure-center"></section>
<section id="another-example-ajr-2001-ii" class="slide level2">
<h2>Another Example: AJR (2001) II</h2>
<ul>
<li>Acemoglu, Johnson, and Robinson (2001): countries’ wealth or poverty today depends strongly on how they were colonized.</li>
<li>Europeans set up one of two types of colonies depending on the disease environment of the country:
<ul>
<li><strong>“Extractive institutions”</strong>: Europeans facing high mortality rates set up extractive colonies primarily to exploit indigenous population to mine resources to ship back to Europe</li>
<li><strong>“Inclusive institutions”</strong>: Europeans facing low mortality rates set up inclusive colonies primarily for settlement and promoting open access to trade and politics</li>
</ul></li>
<li>Those initial colonies carried through to institutions in present countries; inclusive colonies grew wealthy, extractive colonies remain stagnant</li>
</ul>
<p><span class="source">Acemoglu, Daron, Simon Johnson, and James A Robinson, (2001), “The Colonial Origins of Comparative Development: An Empirical Investigation,” <em>American Economic Review</em> 91(5): 1369-1401</span></p>
</section>
<section id="another-example-ajr-2001-iii" class="slide level2">
<h2>Another Example: AJR (2001) III</h2>
<ul>
<li>Instrument: Settler Mortality in 1500</li>
<li><strong>Inclusion Restriction</strong>: Settler mortality in 1500 determines risk of expropriation today</li>
<li><strong>{Exclusion Restriction</strong>: Settler mortality in 1500 <strong>does not</strong> affect Present GDP
<ul>
<li>Settler mortality in 1500 <strong>only</strong> affects Present GDP <strong>through</strong> institutions determined by historical path set by settler mortality rates</li>
</ul></li>
</ul>

<img data-src="images/ajr3.png" class="r-stretch quarto-figure-center"><p><span class="source">Acemoglu, Daron, Simon Johnson, and James A Robinson, (2001), “The Colonial Origins of Comparative Development: An Empirical Investigation,” <em>American Economic Review</em> 91(5): 1369-1401</span></p>
</section>
<section id="another-example-ajr-2001-iv" class="slide level2">
<h2>Another Example: AJR (2001) IV</h2>
<ul>
<li>First Stage:</li>
</ul>
<p><span class="math display">\[\text{Expropriation Risk}_i=\gamma_0+\gamma_1ln(\text{Settler Mortality in 1500}_i)+\gamma_2Controls+\nu_i\]</span></p>
<div class="fragment">
<ul>
<li>Second Stage:</li>
</ul>
<p><span class="math display">\[\text{ln(Present GDP per capita)}=\beta_0+\beta_1\widehat{\text{Expropriation Risk}_i}+\cdots+\beta_2\text{Controls}+u
_i\]</span></p>
</div>
</section>
<section id="another-example-ajr-2001-v" class="slide level2">
<h2>Another Example: AJR (2001) V</h2>
<p>Relationship Between <span class="math inline">\(Y\)</span> and <span class="math inline">\(IV\)</span></p>

<img data-src="images/ajr1.png" class="r-stretch quarto-figure-center"></section>
<section id="another-example-ajr-2001-vi" class="slide level2">
<h2>Another Example: AJR (2001) VI</h2>
<p>Relationship Between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span></p>

<img data-src="images/ajr5.png" class="r-stretch quarto-figure-center"></section>
<section id="another-example-ajr-2001-vii" class="slide level2">
<h2>Another Example: AJR (2001) VII</h2>
<p>Relationship Between <span class="math inline">\(X\)</span> and <span class="math inline">\(IV\)</span></p>

<img data-src="images/ajr6.png" class="r-stretch quarto-figure-center"></section>
<section id="another-example-ajr-2001-viii" class="slide level2">
<h2>Another Example: AJR (2001) VIII</h2>
<p>2SLS Results</p>

<img data-src="images/ajr7.png" class="r-stretch quarto-figure-center"></section></section>
<section>
<section id="simultaneous-causation-structural-equation-modeling-1" class="title-slide slide level1 centered center" data-background-color="#314f4f">
<h1>Simultaneous Causation &amp; Structural Equation Modeling</h1>

</section>
<section id="simultaneous-causation" class="slide level2">
<h2>Simultaneous Causation</h2>
<ul>
<li>Another classic use of instrumental variables in econometrics is to break through the problem of <span class="hi">simultaneous causation</span></li>
</ul>
<p><span class="math display">\[X \leftrightarrow Y\]</span></p>
<ul>
<li>This is a major source of endogeneity</li>
</ul>
</section>
<section id="supply-and-demand" class="slide level2">
<h2>Supply and Demand</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="5.3-slides_files/figure-revealjs/unnamed-chunk-26-1.png" width="960"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li><p>A famous example, foundational to our discipline, <span class="red">Supply</span> and <span class="blue">Demand</span></p></li>
<li><p>Suppose you have data on price and quantity, and want to estimate a <span class="blue">Demand curve</span> with regression</p></li>
</ul>
</div>
</div>
</section>
<section id="supply-and-demand-1" class="slide level2">
<h2>Supply and Demand</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="5.3-slides_files/figure-revealjs/unnamed-chunk-27-1.png" width="960"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li><p>A famous example, foundational to our discipline, <span class="red">Supply</span> and <span class="blue">Demand</span></p></li>
<li><p>Suppose you have data on price and quantity, and want to estimate a <span class="blue">Demand curve</span> with regression</p></li>
<li><p>Why can’t we estimate the demand curve with a simple regression here?</p></li>
</ul>
<p><span class="math display">\[\ln(\text{Quantity}_{it}) = \beta_0 + \beta_1 \ln(\text{Price}_{it}) + u_{it}\]</span></p>
<ul>
<li>With natural logs, <span class="math inline">\(\beta_1\)</span> is the <span class="hi-purple">price elasticity of Demand</span></li>
</ul>
</div>
</div>
</section>
<section id="supply-and-demand-simultaneous-causality" class="slide level2">
<h2>Supply and Demand: Simultaneous Causality</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="5.3-slides_files/figure-revealjs/unnamed-chunk-28-1.png" width="960"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li><p>The data are actually all equilibrium <span class="math inline">\((Q^*,P^*)\)</span> points!</p></li>
<li><p>Result of many demand and supply curve shifts &amp; intersections!</p></li>
</ul>
</div>
</div>
</section>
<section id="supply-and-demand-simultaneous-causality-1" class="slide level2">
<h2>Supply and Demand: Simultaneous Causality</h2>
<ul>
<li><span class="hi">Structural equation model (SEM)</span> of <span class="blue">demand</span> and of <span class="red">supply</span>:</li>
</ul>
<p><span class="math display">\[\begin{align*}
\color{blue}{Q_D} &amp; \color{blue}{= \alpha_0 + \alpha_1 P + \alpha_2 M + u_D} \\
\color{red}{Q_S} &amp; \color{red}{= \beta_0 + \beta_1 P + \beta_2 C+ u_S} \\
\end{align*}\]</span></p>
<div class="fragment">
<ul>
<li><span class="math inline">\(\alpha\)</span>’s and <span class="math inline">\(\beta\)</span>’s are parameters (to be estimated), <span class="math inline">\(u\)</span>’s are unobserved error terms</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="math inline">\(P\)</span> is price
<ul>
<li>Notice <span class="math inline">\(P\)</span> <span class="hi">simultaneously determines</span> <span class="math inline">\(\color{blue}{Q_D}\)</span> <em>and</em> <span class="math inline">\(\color{red}{Q_S}\)</span>!</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="math inline">\(\color{blue}{M}\)</span> are variables that shift demand (i.e.&nbsp;income, prices of other goods, etc)</li>
<li><span class="math inline">\(\color{red}{C}\)</span> are variables that shift supply (i.e.&nbsp;costs, etc)</li>
</ul>
</div>
</section>
<section id="supply-and-demand-simultaneous-causality-2" class="slide level2">
<h2>Supply and Demand: Simultaneous Causality</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="5.3-slides_files/figure-revealjs/unnamed-chunk-29-1.png" width="960"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><span class="math display">\[\color{blue}{Q_D = \alpha_0 + \alpha_1 P + \alpha_2 M + u_D}\]</span></p>
<ul>
<li><p>Why can’t we just estimate price elasticity of demand <span class="math inline">\((\alpha_1)\)</span> with the demand equation?</p></li>
<li><p><span class="math inline">\(P\)</span> is partially a function of <span class="red">quantity supplied</span>!</p></li>
</ul>
</div>
</div>
</section>
<section id="supply-and-demand-simultaneous-causality-3" class="slide level2">
<h2>Supply and Demand: Simultaneous Causality</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="5.3-slides_files/figure-revealjs/unnamed-chunk-30-1.png" width="960"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li><p><span class="hi">Instrumental variables</span> can identify the demand relationship</p></li>
<li><p>Conceptually, use some supply shifter (like cost changes, <span class="math inline">\(\color{red}{C})\)</span> correlated with price <span class="math inline">\(\color{blue}{P}\)</span>, but not correlated with <span class="math inline">\(\color{blue}{u_D}\)</span></p></li>
<li><p>Essentially: traces out unique <span class="blue">demand</span> relationship by allowing <span class="red">supply</span> to vary &amp; shift</p></li>
<li><p>Then, can estimate demand elasticity <span class="math inline">\(\beta_1\)</span></p></li>
</ul>
</div>
</div>
</section>
<section id="demand-example" class="slide level2 smaller">
<h2>Demand Example</h2>
<div class="callout callout-tip callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example</strong></p>
</div>
<div class="callout-content">
<p>Consider the consumption of broiler chickens from 1960-1999</p>
</div>
</div>
</div>
<p><span class="math display">\[\ln \text{quantity}_{t} = \beta_0 + \beta_1 \, \ln \text{price of chicken}_{t} + \beta_2 \, \ln\text{price of beef}_{t} + \beta_3 \, \ln\text{population}_{t} + \beta_4 \, \ln\text{income}_{t}+u_{t}\]</span></p>
<p><span class="source">Data from Epple, Dennis and Bennett T McCallum, 2006, <a href="http://cob.jmu.edu/doylejm/EC%20485docs/chicken_economicinquiry.pdf">“Simultaneous Equation Econometrics: The Missing Example,”</a> <em>Economic Inquiry</em> 44(2): 374-384</span></p>
</section>
<section id="demand-example-1" class="slide level2">
<h2>Demand Example</h2>

<img data-src="5.3-slides_files/figure-revealjs/unnamed-chunk-31-1.png" width="960" class="r-stretch"></section>
<section id="demand-example-2" class="slide level2 smaller">
<h2>Demand Example 😨</h2>

<img data-src="5.3-slides_files/figure-revealjs/unnamed-chunk-32-1.png" width="960" class="r-stretch"></section>
<section id="demand-example-3" class="slide level2 smaller">
<h2>Demand Example 😨</h2>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>demand_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_quantity <span class="sc">~</span> log_price, <span class="at">data =</span> chick) </span>
<span id="cb15-2"><a href="#cb15-2"></a>demand_reg <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"10.624243","3":"0.24379185","4":"43.57916","5":"4.710787e-34"},{"1":"log_price","2":"1.258234","3":"0.05445641","4":"23.10535","5":"5.633462e-24"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="demand-example-with-controls" class="slide level2 smaller">
<h2>Demand Example With Controls</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>demand_reg_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_quantity <span class="sc">~</span> log_price <span class="sc">+</span> log_income <span class="sc">+</span> log_beef <span class="sc">+</span> log_pop <span class="sc">+</span> CPI, <span class="at">data =</span> chick) </span>
<span id="cb16-2"><a href="#cb16-2"></a>demand_reg_2 <span class="sc">%&gt;%</span> <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"-3.292070075","3":"1.5759805026","4":"-2.0889028","5":"4.427456e-02"},{"1":"log_price","2":"-0.280941924","3":"0.0902419635","4":"-3.1132071","5":"3.740775e-03"},{"1":"log_income","2":"0.115668464","3":"0.2169579441","4":"0.5331377","5":"5.974062e-01"},{"1":"log_beef","2":"-0.048977631","3":"0.0630734442","4":"-0.7765175","5":"4.428124e-01"},{"1":"log_pop","2":"3.592875888","3":"0.5949973217","4":"6.0384741","5":"7.677372e-07"},{"1":"CPI","2":"0.004718508","3":"0.0009382211","4":"5.0292069","5":"1.574394e-05"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li><p><span class="math inline">\(\hat{\beta_1}\)</span>: price elasticity of demand is -0.28%</p></li>
<li><p>But this is biased! Endogeneity from simultaneous causation with supply <em>and</em> demand!</p></li>
</ul>
</div>
</section>
<section id="consider-the-causality" class="slide level2">
<h2>Consider the Causality</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="5.3-slides_files/figure-revealjs/unnamed-chunk-36-1.png" width="960"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>Factors that influence <span class="blue">quantity demanded</span>:
<ul>
<li><span class="red">price</span> (endogenous! — partly determined by <span class="purple">supply</span>!)</li>
<li>price of substitutes (beef)</li>
<li>income</li>
<li>number of buyers (population)</li>
<li>price level (CPI)</li>
<li>other unobservables (u)</li>
</ul></li>
<li>Factors that influence price <span class="purple">(on the supply side)</span>
<ul>
<li>price of inputs/costs (feed and corn)</li>
<li>use these as <strong>instruments</strong> for price!</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="instruments" class="slide level2 smaller">
<h2>Instruments</h2>
<ul>
<li><p>Use supply shifters, <span class="red">Price of Feed</span> and <span class="red">Price of Corn</span> (inputs/costs to raising chickens) as instruments for <span class="blue">Chicken price</span></p></li>
<li><p>Are they <span class="hi-purple">relevant</span>? Check the first stage</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>demand_first_stage <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_price <span class="sc">~</span> log_feed_price <span class="sc">+</span> log_corn_price <span class="sc">+</span> log_income <span class="sc">+</span> log_beef <span class="sc">+</span> log_pop <span class="sc">+</span> CPI, <span class="at">data =</span> chick)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="fu">tidy</span>(demand_first_stage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"3.091394544","3":"3.036679535","4":"1.01801804","5":"0.316075264"},{"1":"log_feed_price","2":"0.291891404","3":"0.145199951","4":"2.01027206","5":"0.052634060"},{"1":"log_corn_price","2":"0.012500512","3":"0.097284821","4":"0.12849396","5":"0.898537994"},{"1":"log_income","2":"0.733391303","3":"0.369170669","4":"1.98659147","5":"0.055323296"},{"1":"log_beef","2":"-0.005344296","3":"0.121075174","4":"-0.04414031","5":"0.965058576"},{"1":"log_pop","2":"-1.397997593","3":"1.102062552","4":"-1.26852835","5":"0.213485189"},{"1":"CPI","2":"0.006140411","3":"0.001825306","4":"3.36404568","5":"0.001958978"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">glance</span>(demand_first_stage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["r.squared"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["adj.r.squared"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sigma"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["df.residual"],"name":[11],"type":["int"],"align":["right"]},{"label":["nobs"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"0.9864229","2":"0.9839544","3":"0.0539911","4":"399.5947","5":"2.450699e-29","6":"6","7":"63.84734","8":"-111.6947","9":"-98.18364","10":"0.09619628","11":"33","12":"40"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li><p><code>statistic</code> <span class="math inline">\((F\)</span>) is high enough, jointly significant</p></li>
<li><p>Can also see correlations: ::: {.cell} ::: {.cell-output .cell-output-stdout}</p></li>
</ul>
<pre><code>               log_price log_feed_price log_corn_price
log_price      1.0000000      0.9464933      0.7742719
log_feed_price 0.9464933      1.0000000      0.9097980
log_corn_price 0.7742719      0.9097980      1.0000000</code></pre>
<p>::: :::</p>
</section>
<section id="instruments-1" class="slide level2 smaller">
<h2>Instruments</h2>
<ul>
<li><p>Use supply shifters, <span class="red">Price of Feed</span> and <span class="red">Price of Corn</span> (inputs/costs to raising chickens) as instruments for <span class="blue">Chicken price</span></p></li>
<li><p>Are they <span class="hi-purple">exogenous</span>?</p></li>
</ul>
<p><span class="math display">\[\text{cor}(\text{Feed price}, u_D)=0 \quad \quad \quad \text{cor}(\text{Corn price}, u_D)=0\]</span></p>
<ul>
<li>Argue that costs don’t affect factors that affect demand (in error term); only affect supply</li>
</ul>
</section>
<section id="second-stage-1" class="slide level2 smaller">
<h2>Second Stage</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>chick<span class="sc">$</span>price_hat <span class="ot">&lt;-</span> demand_first_stage<span class="sc">$</span>fitted.values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>Now regress quantity on the fitted values of <span class="math inline">\(\widehat{price}\)</span> (from first stage) with all the covariates (from first stage)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>demand_second_stage <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_quantity <span class="sc">~</span> price_hat <span class="sc">+</span> log_income <span class="sc">+</span> log_beef <span class="sc">+</span> log_pop <span class="sc">+</span> CPI, <span class="at">data =</span> chick)</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="fu">tidy</span>(demand_second_stage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"-2.686673617","3":"1.690775142","4":"-1.58901888","5":"1.213132e-01"},{"1":"price_hat","2":"-0.437551695","3":"0.158858181","4":"-2.75435417","5":"9.375725e-03"},{"1":"log_income","2":"0.209226904","3":"0.235386608","4":"0.88886494","5":"3.803215e-01"},{"1":"log_beef","2":"0.004414143","3":"0.078219995","4":"0.05643241","5":"9.553277e-01"},{"1":"log_pop","2":"3.388282917","3":"0.632782246","4":"5.35457962","5":"5.948795e-06"},{"1":"CPI","2":"0.005537623","3":"0.001175213","4":"4.71201725","5":"4.045652e-05"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">glance</span>(demand_second_stage)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["r.squared"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["adj.r.squared"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sigma"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["df.residual"],"name":[11],"type":["int"],"align":["right"]},{"label":["nobs"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"0.9964764","2":"0.9959582","3":"0.03528781","4":"1923.027","5":"1.160973e-40","6":"5","7":"80.26155","8":"-146.5231","9":"-134.7009","10":"0.0423378","11":"34","12":"40"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
</section>
<section id="using-fixest" class="slide level2 smaller">
<h2>Using <code>fixest</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>iv_demand_reg <span class="ot">&lt;-</span> <span class="fu">feols</span>(log_quantity <span class="sc">~</span> log_income <span class="sc">+</span> log_beef <span class="sc">+</span> log_pop <span class="sc">+</span> CPI <span class="sc">|</span> log_price <span class="sc">~</span> log_feed_price <span class="sc">+</span> log_corn_price, <span class="at">data =</span> chick)</span>
<span id="cb23-2"><a href="#cb23-2"></a>iv_demand_reg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>TSLS estimation, Dep. Var.: log_quantity, Endo.: log_price, Instr.: log_feed_price, log_corn_price
Second stage: Dep. Var.: log_quantity
Observations: 40 
Standard-errors: IID 
               Estimate Std. Error   t value   Pr(&gt;|t|)    
(Intercept)   -2.686674   1.721040 -1.561075 1.2777e-01    
fit_log_price -0.437552   0.161702 -2.705918 1.0572e-02 *  
log_income     0.209227   0.239600  0.873234 3.8866e-01    
log_beef       0.004414   0.079620  0.055440 9.5611e-01    
log_pop        3.388283   0.644109  5.260417 7.8866e-06 ***
CPI            0.005538   0.001196  4.629155 5.1702e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
RMSE: 0.033116   Adj. R2: 0.995812
F-test (1st stage), log_price: stat = 8.46361, p = 0.001079, on 2 and 33 DoF.
                   Wu-Hausman: stat = 1.57081, p = 0.218897, on 1 and 33 DoF.
                       Sargan: stat = 2.88552, p = 0.089379, on 1 DoF.</code></pre>
</div>
</div>
</section>
<section id="comparing" class="slide level2 smaller">
<h2>Comparing</h2>
<div class="cell">
<div class="cell-output-display">

<table style="NAborder-bottom: 0; width: auto !important; margin-left: auto; margin-right: auto;" class="table">
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:center;"> OLS </th>
   <th style="text-align:center;"> OLS  </th>
   <th style="text-align:center;"> 2SLS (by hand) </th>
   <th style="text-align:center;"> 2SLS (fixest) </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Constant </td>
   <td style="text-align:center;"> 10.624*** </td>
   <td style="text-align:center;"> −3.292** </td>
   <td style="text-align:center;"> −2.687 </td>
   <td style="text-align:center;"> −2.687 </td>
  </tr>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:center;"> (0.244) </td>
   <td style="text-align:center;"> (1.576) </td>
   <td style="text-align:center;"> (1.691) </td>
   <td style="text-align:center;"> (1.721) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Log Price/lb of Chicken </td>
   <td style="text-align:center;"> 1.258*** </td>
   <td style="text-align:center;"> −0.281*** </td>
   <td style="text-align:center;"> −0.438*** </td>
   <td style="text-align:center;"> −0.438** </td>
  </tr>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:center;"> (0.054) </td>
   <td style="text-align:center;"> (0.090) </td>
   <td style="text-align:center;"> (0.159) </td>
   <td style="text-align:center;"> (0.162) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Log Income </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> 0.116 </td>
   <td style="text-align:center;"> 0.209 </td>
   <td style="text-align:center;"> 0.209 </td>
  </tr>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> (0.217) </td>
   <td style="text-align:center;"> (0.235) </td>
   <td style="text-align:center;"> (0.240) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Log Price/lb of Beef </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> −0.049 </td>
   <td style="text-align:center;"> 0.004 </td>
   <td style="text-align:center;"> 0.004 </td>
  </tr>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> (0.063) </td>
   <td style="text-align:center;"> (0.078) </td>
   <td style="text-align:center;"> (0.080) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Log Population </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> 3.593*** </td>
   <td style="text-align:center;"> 3.388*** </td>
   <td style="text-align:center;"> 3.388*** </td>
  </tr>
  <tr>
   <td style="text-align:left;">  </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> (0.595) </td>
   <td style="text-align:center;"> (0.633) </td>
   <td style="text-align:center;"> (0.644) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> CPI </td>
   <td style="text-align:center;">  </td>
   <td style="text-align:center;"> 0.005*** </td>
   <td style="text-align:center;"> 0.006*** </td>
   <td style="text-align:center;"> 0.006*** </td>
  </tr>
  <tr>
   <td style="text-align:left;box-shadow: 0px 1px">  </td>
   <td style="text-align:center;box-shadow: 0px 1px">  </td>
   <td style="text-align:center;box-shadow: 0px 1px"> (0.001) </td>
   <td style="text-align:center;box-shadow: 0px 1px"> (0.001) </td>
   <td style="text-align:center;box-shadow: 0px 1px"> (0.001) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> n </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 40 </td>
   <td style="text-align:center;"> 40 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Adj. R<sup>2</sup> </td>
   <td style="text-align:center;"> 0.93 </td>
   <td style="text-align:center;"> 1.00 </td>
   <td style="text-align:center;"> 1.00 </td>
   <td style="text-align:center;"> 1.00 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> SER </td>
   <td style="text-align:center;"> 0.14 </td>
   <td style="text-align:center;"> 0.03 </td>
   <td style="text-align:center;"> 0.03 </td>
   <td style="text-align:center;"> 0.03 </td>
  </tr>
</tbody>
<tfoot><tr><td style="padding: 0; " colspan="100%">
<sup></sup> * p &lt; 0.1, ** p &lt; 0.05, *** p &lt; 0.01</td></tr></tfoot>
</table>

</div>
</div>

<img src="../images/metrics_hex.png" class="slide-logo r-stretch"><div class="footer footer-default">
<p><a href="https://metricsF22.classes.ryansafner.com">ECON 480 — Econometrics</a></p>
</div>
</section></section>

    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="5.3-slides_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="5.3-slides_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="5.3-slides_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="5.3-slides_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="5.3-slides_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="5.3-slides_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="5.3-slides_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="5.3-slides_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="5.3-slides_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="5.3-slides_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="5.3-slides_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        function fireSlideChanged(previousSlide, currentSlide) {

          // dispatch for htmlwidgets
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for reveal
        if (window.Reveal) {
          window.Reveal.addEventListener("slidechanged", function(event) {
            fireSlideChanged(event.previousSlide, event.currentSlide);
          });
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        setTimeout(function() {
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          let href = ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const cites = ref.parentNode.getAttribute('data-cites').split(' ');
        tippyHover(ref, function() {
          var popup = window.document.createElement('div');
          cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    });
    </script>
    

</body></html>